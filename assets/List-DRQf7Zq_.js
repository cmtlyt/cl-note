var g=Object.freeze,C=Object.defineProperty;var v=(n,l)=>g(C(n,"raw",{value:g(l||n.slice())}));import{B as j,d as h,e as B,j as r,a as e,f as D,p as P,$ as S,S as $,h as k,c as w}from"./index-BBCHSHPU.js";import{n as I,S as F,D as p,E as f,G as E,q as A,r as x,H as N,I as W}from"./react-vendor-CdR2uZhc.js";import{S as L,C as G}from"./Select-BkQq_9EH.js";import{h as O,g as T}from"./bill-C_U6aCdF.js";import"./__commonjsHelpers__-Cpj98o6Y.js";const M=new j({billList:[]}),Y=B(M),q=I(()=>M),H=h(q,"billList");function m(n){const{amount:l,showSign:t=!0,decimal:s=2,...c}=n,o=l<0?"-":"+";return r("div",{"un-flex":"~ items-center","un-flex-shrink":"0",...c,children:[t&&e("span",{"un-m":"r-[0.25rem]",children:o}),e("span",{children:D(Math.abs(l),s)})]})}const z=new j({outputAmount:0,inputAmount:0,year:new Date().getFullYear(),month:0}),R=B(z),d=I(()=>z),U=h(d,"outputAmount"),V=h(d,"inputAmount"),J=h(d,"year"),K=h(d,"month"),Q=n=>O.get("/billStatistics",{params:n});var y;const X=P.div(y||(y=v(["\n  box-shadow: 0.2rem 0.2rem 1rem -0.8rem var(--shadow-color);\n"])));function b(n){const{children:l,...t}=n;return e(E,{children:e("span",{"un-text":"[1.4rem]",...t,children:l})})}function Z(){const n=A(J),l=A(K);return r(p,{"un-flex":"~ col justify-between items-start",children:[e(b,{children:e(L,{onChange:t=>n(Number(t)),placeholder:{label:"2024年",value:"2024"},options:[{label:"2023年",value:"2023"},{label:"2022年",value:"2022"}]})}),e(f,{"un-line-height":"[3.6rem]","un-h":"[3.6rem]","un-w":"full",children:e(L,{"un-flex":"~ items-center justify-between","un-text":"[2.4rem]","un-w":"[7rem]","un-whitespace":"nowrap",placeholder:{label:"全年",value:"0"},options:[{label:"1月",value:"1"},{label:"2月",value:"2"},{label:"3月",value:"3"},{label:"4月",value:"4"},{label:"5月",value:"5"},{label:"6月",value:"6"},{label:"7月",value:"7"},{label:"8月",value:"8"},{label:"9月",value:"9"},{label:"10月",value:"10"},{label:"11月",value:"11"},{label:"12月",value:"12"}],onChange:t=>l(Number(t)),children:e($,{slot:"icon",name:"arrow-bottom","un-size":"[1.2rem]","un-color":"$detail-text-color"})})})]})}function _(){return ee(),r(X,{"un-flex":"~ items-end","un-bg":"white","un-p":"x-[2rem] y-[2rem]","un-m":"b-[1rem]",children:[e(Z,{}),e("div",{"un-h":"[3rem]","un-w":"[0.1rem]","un-bg":"$detail-color","un-rounded":"full","un-m":"x-[2rem]"}),r(F,{"un-flex":"[3]",children:[r(p,{children:[e(b,{children:"本月支出"}),e(f,{"un-h":"[3.6rem]","un-flex":"~ items-center","un-color":"$danger-color","un-line-height":"[3.6rem]",children:e(m,{amount:S(U),showSign:!1,"un-font":"bold","un-text":"[2.8rem]"})})]}),r(p,{children:[e(b,{children:"本月收入"}),e(f,{"un-h":"[3.6rem]","un-flex":"~ items-center","un-color":"$success-color","un-line-height":"[3.6rem]",children:e(m,{amount:S(V),showSign:!1,"un-font":"bold","un-text":"[2.8rem]"})})]})]})]})}function ee(){Q().then(n=>{const{billStatistics:{pay:l,income:t}}=n.data;R({inputAmount:t,outputAmount:l})})}const te=G;function ne(n){const{amountInfo:{id:l,title:t,amount:s,icon:c},onClick:o,...u}=n;return r(te,{onClick:()=>o==null?void 0:o(l),"un-flex":"~ items-center","un-w":"full","un-p":"[1rem]",...u,children:[e($,{name:c,"un-size":"$big-icon-size","un-flex-shrink":"0","un-m":"r-[0.5rem]"}),e("span",{"un-flex":"1","un-line-clamp":"1",children:t}),e(m,{amount:s,"un-m":"l-[0.5rem]"})]})}function le(n){const{date:l,billList:t}=n,{shouru:s,zhichu:c}=x.useMemo(()=>{const o=t.reduce((i,a)=>a.amount>0?i+a.amount:i,0),u=t.reduce((i,a)=>a.amount<0?i-a.amount:i,0);return{shouru:o,zhichu:u}},[t]);return r("div",{"un-flex":"~ items-center justify-between","un-m":"b-[1rem] t-[1rem]","un-text":"[1.4rem]",children:[e("span",{children:l}),r("div",{"un-flex":"~ items-center","un-color":"$detail-text-color",children:[!!s&&r("div",{"un-m":"x-[0.5rem]","un-flex":"~ items-center",children:[e("span",{"un-m":"r-[0.5rem]",children:"收入:"}),e(m,{amount:s,showSign:!1})]}),!!c&&r("div",{"un-m":"x-[0.5rem]","un-flex":"~ items-center",children:[e("span",{"un-m":"r-[0.5rem]",children:"支出:"}),e(m,{amount:c,showSign:!1})]})]})]})}function oe(n){const{bills:l,onClick:t,...s}=n,c=x.useMemo(()=>l.reduce((o,u)=>{const a=k(u.date).format("MM月DD日 dddd").toString();return o[a]||(o[a]=[]),o[a].push(u),o},{}),[l]);return e("div",{"un-flex":"~ col","un-w":"full","un-p":"x-[1rem]",...s,children:Object.entries(c).map(([o,u])=>r(N.Fragment,{children:[e(le,{date:o,billList:u}),u.map(i=>e(ne,{amountInfo:i,onClick:t,"un-m":"b-[1rem]"},i.id))]},o))})}function re(){const n=W(H),l=x.useMemo(()=>n.map(t=>({id:t.id,title:t.title,amount:t.amount,icon:t.consumeTypeInfo.icon,date:t.date})),[n]);return e(oe,{bills:l,onClick:t=>console.log(t)})}function he(){return r("div",{"un-h":"full","un-flex":"~ col",children:[e(_,{}),e("div",{"un-overflow":"y-auto",children:e(re,{})})]})}async function de(){return w({showLoading:!0}),T({current:1,pageSize:10}).then(n=>{Y({billList:n.data.bills})}).finally(()=>{w({showLoading:!1})}),{}}export{he as default,de as loader};
